<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
<meta charset=utf-8>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CDK4087KM8"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-CDK4087KM8',{anonymize_ip:!1})}</script>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<meta name=HandheldFriendly content="True">
<meta name=MobileOptimized content="320">
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=apple-touch-icon sizes=180x180 href=https://crmejia.github.io/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://crmejia.github.io/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://crmejia.github.io/favicon-16x16.png>
<link rel=manifest href=https://crmejia.github.io/site.webmanifest>
<link rel=mask-icon href=https://crmejia.github.io/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<meta name=description content="CityGuide is a WebApp to help you discover and share cool spots in cities. These guides are useful for backpackers, digital nomads, and people new in town that are keen to discover cool things">
<meta name=keywords content="Go,
Digital Ocean,
Terraform,
SQLite,
Nginx,
">
<meta property="og:title" content="CityGuide: Go WebApp to Share Locations">
<meta property="og:description" content="CityGuide is a WebApp to help you discover and share cool spots in cities. These guides are useful for backpackers, digital nomads, and people new in town that are keen to discover cool things">
<meta property="og:type" content="article">
<meta property="og:url" content="https://crmejia.github.io/posts/city_guide/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-12-26T16:50:08-04:00">
<meta property="article:modified_time" content="2022-12-26T16:50:08-04:00">
<meta property="og:site_name" content="Crismar.Me">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="CityGuide: Go WebApp to Share Locations">
<meta name=twitter:description content="CityGuide is a WebApp to help you discover and share cool spots in cities. These guides are useful for backpackers, digital nomads, and people new in town that are keen to discover cool things">
<meta itemprop=name content="CityGuide: Go WebApp to Share Locations">
<meta itemprop=description content="CityGuide is a WebApp to help you discover and share cool spots in cities. These guides are useful for backpackers, digital nomads, and people new in town that are keen to discover cool things"><meta itemprop=datePublished content="2022-12-26T16:50:08-04:00">
<meta itemprop=dateModified content="2022-12-26T16:50:08-04:00">
<meta itemprop=wordCount content="1246">
<meta itemprop=keywords content="Go,Digital Ocean,Terraform,SQLite,Nginx,">
<title>CityGuide: Go WebApp to Share Locations || Crismar.Me</title>
<link rel=canonical href=https://crmejia.github.io/posts/city_guide/>
<link rel=stylesheet href=/css/reboot.css>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=/css/syntax.css>
<script type=text/javascript src=/js/main.js></script>
<link href="https://fonts.googleapis.com/css?family=Lora&display=swap" rel=stylesheet>
<link rel="shortcut icon" href=/favicon.ico type=image/x-icon>
<link rel=apple-touch-icon href=/apple-touch-icon.png>
</head>
<body lang=en-us>
<div class="navbar nav-bkg drop-shadow">
<nav class="content-container pagewide-bar-padding">
<span class=divider>/ </span>
<a href=/>Crismar.Me</a>
<span class=divider>/ </span>
<a href=/posts/>Posts</a>
<ul class="list-unstyled right-links">
<li>
<a href=/about/>
<span class=post-title>about</span>
</a>
</li>
<li>
<a href=/posts/>
<span class=post-title>blog</span>
</a>
</li>
<li>
<a href=/consulting/>
<span class=post-title>consulting</span>
</a>
</li>
</ul>
</nav>
</div>
<article id=main class="content-container look-sheet article-pad-v" itemscope itemtype=https://schema.org/Article>
<meta itemprop=author content>
<meta itemprop=publisher content>
<meta itemprop=image content>
<h1 itemprop=name id=title>CityGuide: Go WebApp to Share Locations</h1>
<meta itemprop=headline content="CityGuide: Go WebApp to Share Locations">
<div class=post-tags>
<a href=https://crmejia.github.io/tags/go/>#Go</a>&nbsp;
<a href=https://crmejia.github.io/tags/digital-ocean/>#Digital Ocean</a>&nbsp;
<a href=https://crmejia.github.io/tags/terraform/>#Terraform</a>&nbsp;
<a href=https://crmejia.github.io/tags/sqlite/>#SQLite</a>&nbsp;
<a href=https://crmejia.github.io/tags/nginx/>#Nginx</a>&nbsp;
</div>
<div class=post-date><span itemprop=datePublished>December 26, 2022</span></div>
<meta itemprop=dateModified content="December 26, 2022">
<div itemprop=articleBody id=content class="article-body margin-top-2em">
<h1 id=cityguide-go-webapp-to-share-locations>CityGuide: Go WebApp to Share Locations</h1>
<p><a href=https://github.com/crmejia/CityGuide>CityGuide</a> is a WebApp to help you discover and share cool spots in cities. These guides are useful for backpackers, digital nomads, and people new in town that are keen to discover cool things. For the past year, I‚Äôve been improving my Go coding skills with the goal of achieving a new milestone in my career. Similarly, I‚Äôve been curious about Indie Hacking and MicroSaaS and what it would take for me to create my own product or service. Inspired by Peter Levels‚Äô <a href=https://levels.io/hoodmaps>Hoodmaps</a> creation in public and by an article called <a href=https://blog.thepete.net/blog/2019/10/04/hello-production/>Hello, production</a> I decided to create CityGuide.</p>
<p>The goal of this project was to create a prototype that is deployed in production within a month. So for the month of August, I coded away and kept a log of my progress. Here‚Äôs that log:</p>
<p>Check out the GitHub repository here: <a href=https://github.com/crmejia/CityGuide>https://github.com/crmejia/CityGuide</a></p>
<h2 id=problem>Problem</h2>
<p>As a digital nomad every time I travel to a new place I spend some time locating/discovering places that are useful to my stay: coworkings, gyms, markets, etc. I usually locate these places using a combination of Google Maps, reading blogs, and by asking around. This can take a few days of research which can be a problem for someone that relocates over the weekend and is looking to jump into a routine ASAP, specially if you‚Äôre working a regular 40h week. So it would be nice to be able to share a list of places, a guide, for a new town that answers these questions just by looking at it. In other words, you can see your options.</p>
<h2 id=solution>Solution</h2>
<p>Create an application that creates a city guide that can be shared with others. A city guide contains locations defined with: latitude, longitude, small review, and useful links.</p>
<p>Possible monetization: having hostels/accomodations pay to host the maps that they can offer to guest for free.</p>
<h2 id=motivation>Motivation</h2>
<p>My motivation is to practice my Go skills as well as my product creation skills. I‚Äôm inspired by <a href=https://levels.io/hoodmaps/>Hoodmaps</a> creation in public. Also by <a href=https://blog.thepete.net/blog/2019/10/04/hello-production/>Hello, production</a> because I want to create a product that is running in prod even if it‚Äôs minimal. I believe this would be a great project that can be used as a portfolio.</p>
<h2 id=building>Building</h2>
<h3 id=day-0>Day 0</h3>
<p>Monday, <em>August 1</em></p>
<p>Reading the hoodmaps blog posts and Hello, production.</p>
<h3 id=day-1>Day 1</h3>
<p>Playing around with LeafletJS to see what is needed to draw locations on a map and familiarize myself with needed data. Followed this tutorial <a href=https://leafletjs.com/examples/quick-start/>https://leafletjs.com/examples/quick-start/</a></p>
<p>Reading: ‚ÄúTracer Bullet‚Äù chapter in Pragmatic Programmer.</p>
<h3 id=day-2>Day 2</h3>
<p>Started ‚ÄúCity Guide‚Äù Go project. Decided to deploy <em>Hello World on Prod</em> as a map centered around a town.</p>
<h3 id=day-3>Day 3</h3>
<p>Spend some time reading about: mapping projects, deployments, and CICD. The former two mostly by browsing Digital Ocean Community docs. Decided to deploy on my DO droplet</p>
<ul>
<li><a href=https://www.digitalocean.com/community/tutorials/how-to-deploy-a-go-web-application-using-nginx-on-ubuntu-18-04>https://www.digitalocean.com/community/tutorials/how-to-deploy-a-go-web-application-using-nginx-on-ubuntu-18-04</a></li>
</ul>
<p>Added a simple HTTP server serving a map. Tomorrow going to server it on Digital Ocean.</p>
<h3 id=day-4>Day 4</h3>
<p>First order of the day is reorganizing my toolbox and processes. Focusing on simplicity and moving forward. I ended up setting up my own git server using this <a href=https://git-scm.com/book/en/v2/Git-on-the-Server-Setting-Up-the-Server>guide</a>.</p>
<h3 id=day-5>Day 5</h3>
<p>Deploying on server.</p>
<h3 id=day-6>Day 6</h3>
<p><em>Sunday, August 7</em></p>
<p>While configuring the current server that host my blog(Crismar.me) I managed to locked myself out of the machine. I tried a few things like copying the <code>.ssh/authorized_keys</code> and even the Digital Ocean droplet recovery consul to no avail.</p>
<h3 id=day-7>Day 7</h3>
<p><em>Monday, August 8</em></p>
<p>Started a new server(droplet) from scratch. Set up a git server. Installed Go.</p>
<h3 id=day-8>Day 8</h3>
<p><em>Tuesday, August 9</em></p>
<p>Setting up nginx!</p>
<p>I spend about 2 hours reading about firewalls and ufw.</p>
<p>As silly as it may sound, I spent most of my working day trying to figure what Go does with templates and assets. I discovered while deploying to prod that the template that I had created was not included in the binary so I‚Äôm getting an error when trying to reach the site‚Äôs index. I‚Äôve asked in the <a href=https://gophers.slack.com/archives/C02A8LZKT/p1660068047198189>Go‚Äôs #newbies channel</a> and in <a href=https://bitfieldconsulting.com>Bitfield‚Äôs</a> #go channel. I was hoping for a definitive answer or some guidance on how this should be done when deploying. How was it done before the new <code>embed</code> package?</p>
<h3 id=day-9>Day 9</h3>
<p><em>Wednesday, August 10</em></p>
<p>Used <code>embed</code> and it&rsquo;s now live here <a href=http://142.93.188.236>http://142.93.188.236</a> !</p>
<p>I‚Äôll have to build a Delivery pipeline</p>
<h3 id=day-10>Day 10</h3>
<p><em>Thursday, August 11</em></p>
<p>Back to the code!</p>
<h3 id=day-11>Day 11</h3>
<p><em>Friday, August 12</em></p>
<p>Decided to introduce IDs as the index to Guides instead of coordinates. That meant a lot of refactoring.</p>
<h3 id=day-12>Day 12</h3>
<p><em>Tuesday, August 16</em></p>
<p>Realized that POIs(Points of Interests) also ought to be indexed by IDs rather than coordinates(which are not necessarily unique). Also realized that POIs being a (hash)map adds unnecessary complexity because it makes into a ‚Äústore‚Äù entity which means it needs CRUD. To avoid complexity, I‚Äôm keeping it simple as an array. This was the first lesson of the day.</p>
<p>Another interesting lesson, is the fact that I cannot template a variable inside a script block <a href=https://go.dev/play/p/Kuw9QokufWC>https://go.dev/play/p/Kuw9QokufWC</a> I was about to ask on StackOverflow until I realized that this could be accomplished directly using Javascript. Something tells me this is on purpose.</p>
<h3 id=day-13>Day 13</h3>
<p><em>Wednesday, August 17</em></p>
<p>Create Guide!</p>
<h3 id=day-14>Day 14</h3>
<p><em>Thursday, August 18</em></p>
<p>Finished <code>/guide/create</code> with decent form validation.</p>
<h3 id=day-15>Day 15</h3>
<p><em>Friday, August 19</em></p>
<p>I‚Äôve realized that I‚Äôm closing in on 49 hours of work on this project and in the interest of keeping it short I‚Äôve got to wrap it up. My current plan is to add the ability to add Points Of Interest to guides, add a DB, and redeploy.</p>
<h3 id=day-16>Day 16</h3>
<p><em>Monday, August 22</em></p>
<p>Added POI creation but it was not at straightforward as I expected. Things like:</p>
<ul>
<li>the route <code>/guide/poi/create</code> was a picked in order to use the standard library‚Äôs <code>http.mux</code></li>
<li>Spend sometimes making the slice of POI persists since the allocated slice was being lost when out of scope.</li>
</ul>
<h3 id=day-17>Day 17</h3>
<p><em>Tuesday, August 23</em></p>
<ul>
<li>
<p>Polishing tests and increasing coverage.</p>
</li>
<li>
<p>Reading about DBs:</p>
<ul>
<li>Great resources, this articles are on üî•
<ul>
<li><a href=https://www.alexedwards.net/blog/introduction-to-using-sql-databases-in-go>https://www.alexedwards.net/blog/introduction-to-using-sql-databases-in-go</a></li>
<li><a href=https://www.alexedwards.net/blog/organising-database-access>https://www.alexedwards.net/blog/organising-database-access</a></li>
</ul>
</li>
<li>As recommend by previous articles:
<ul>
<li><a href=http://go-database-sql.org/importing.html>http://go-database-sql.org/importing.html</a></li>
<li><a href=https://github.com/jmoiron/sqlx>https://github.com/jmoiron/sqlx</a></li>
<li><a href=https://github.com/guregu/null>https://github.com/guregu/null</a></li>
<li><a href=https://github.com/golang/go/issues/11939>https://github.com/golang/go/issues/11939</a></li>
<li><a href=https://www.reddit.com/r/golang/comments/38hkor/go_best_practice_for_accessing_database_in/>https://www.reddit.com/r/golang/comments/38hkor/go_best_practice_for_accessing_database_in/</a></li>
</ul>
</li>
</ul>
<h3 id=day-18>Day 18</h3>
<p><em>Wednesday, August 24</em></p>
<ul>
<li>
<p><strong><strong><a href="https://www.youtube.com/watch?v=RqubKSF3wig">David Crawshaw SQLite and Go</a></strong></strong></p>
<ul>
<li>Entertaining</li>
</ul>
</li>
<li>
<p><strong><strong><a href="https://www.youtube.com/watch?v=XcAYkriuQ1o">GopherCon 2021: Ben Johnson - Building Production Applications Using Go & SQLite</a></strong></strong></p>
<ul>
<li>Nice best practices for a modern sqlite go app.</li>
<li>Execute these:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pragmaWALEnabled</span> = <span style=color:#e6db74>`PRAGMA journal_mode = WAL;`</span>
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pragma500BusyTimeout</span> = <span style=color:#e6db74>`PRAGMA busy_timeout = 5000;`</span>
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pragmaForeignKeysON</span> = <span style=color:#e6db74>`PRAGMA foreign_keys = on=;`</span>

<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>stmt</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> []<span style=color:#66d9ef>string</span>{<span style=color:#a6e22e>pragmaWALEnabled</span>, <span style=color:#a6e22e>pragma500BusyTimeout</span>, <span style=color:#a6e22e>pragma500BusyTimeout</span>} {
		<span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>Exec</span>(<span style=color:#a6e22e>stmt</span>, <span style=color:#66d9ef>nil</span>)
		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
			<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
		}
	}
</code></pre></div></li>
</ul>
<h3 id=day-19--21>Day 19 -21</h3>
<p><em>Thursday, August 25 - Tuesday, August 30</em></p>
<p>Implementing SQLite store.</p>
<h3 id=day-22>Day 22</h3>
<p>Wednesday, August 31</p>
<p>Reorganizing the relation between store, handlers, and guides. I had the idea to move things around to have the compiler help me enforce separation of concerns.</p>
<h3 id=day-23>Day 23</h3>
<p><em>Wednesday, September 7</em></p>
<p><a href=https://github.com/crmejia/CityGuide/releases/tag/v0.0.1-alpha>v0.0.1</a> First release! üéâ</p>
<h3 id=day-24>Day 24</h3>
<p>Thursday, September 8</p>
<p><a href=https://github.com/crmejia/CityGuide/releases/tag/v0.0.2-alpha>v0.0.2</a> Fixed some üêõ</p>
<h2 id=conclusion>Conclusion</h2>
<p>I went a few days over August but was able to accomplish my goal of creating a prototype and improving my Go skills along the way. Later on in November I added users and authentication to familiarize myself with that. As of right now, I‚Äôm considering deploying with containers and using <a href=https://caddyserver.com>Caddy</a> instead of Nginx. Another option is to create a new project from scratch but this time using a framework to see how far I can get in a month and get closer to being able to ship a full product in a month.</p>
</li>
</ul>
</div>
</article>
<div class="nav-bkg-50 content-container-narrow-pad bottom-links text-0p75 drop-shadow">
<nav class=flex-row>
<a href=https://crmejia.github.io/posts/rebuilding-crismar-me-in-terraform/ class="flex-row v-center no-underline" style=max-width:45%>
<span class=text-1p5>‚Üê</span>&nbsp;<span class=re-underline>Previous: Rebuilding crismar.me in Terraform</span>
</a>
<a href=https://crmejia.github.io/posts/domino_count/ class="flex-row v-center no-underline" style=max-width:45%>
<span class=re-underline>Next: Domino Count</span>&nbsp;<span class=text-1p5>‚Üí</span>
</a>
</nav>
</div>
</body>
</html>